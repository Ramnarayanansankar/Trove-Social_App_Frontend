<div class="homepage-container">
  <!-- SIDE NAVIGATION -->
  <app-side-nav
    [userName]="userName"
    [userInitials]="userInitials"
    [profilePicture]="profilePicture"
    [notificationCount]="notificationCount"
    [activeNav]="activeNav"
    (navChange)="setActiveNav($event)"
    (notificationClick)="toggleNotifications()"
    (createClick)="openCreateModal()"
    (logoutClick)="logout()">
  </app-side-nav>

  <!-- MAIN CONTENT -->
  <div class="main-content">

  <!-- CENTERED STATS -->
  <div class="stats">
    <div class="stat">
      <strong>{{ stats.followers }}</strong>
      <span>Followers</span>
    </div>
    <div class="stat">
      <strong>{{ stats.following }}</strong>
      <span>Following</span>
    </div>
    <div class="stat">
      <strong>{{ stats.posts }}</strong>
      <span>Posts</span>
    </div>
  </div>

  <!-- PHOTO GRID -->
  <div class="grid" *ngIf="!loadingPosts">
    <div 
      class="photo" 
      *ngFor="let post of posts"
      (click)="openPostViewer(post)">
      <img 
        *ngIf="getThumbnail(post.postId)" 
        [src]="getThumbnail(post.postId)" 
        alt="Post thumbnail"
        class="photo-image">
      <div class="photo-overlay">
        <div class="photo-multiple-indicator" *ngIf="hasMultipleImages(post)">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M22 16V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2zm-11.5-2L8 10.5l-2.5 3.5L4 12l4-5 4.5 5-1 1z"/>
          </svg>
          <span>{{ post.imageUrls.length }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="loadingPosts">
    <div class="loading-spinner"></div>
    <p>Loading posts...</p>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!loadingPosts && posts.length === 0">
    <svg class="empty-icon" viewBox="0 0 24 24" fill="currentColor">
      <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
    </svg>
    <p>No posts yet. Create your first post!</p>
  </div>

  <!-- NOTIFICATIONS DRAWER -->
  <div class="drawer" [class.show]="showNotifications">
    <div class="drawer-header">
      <h3>Notifications</h3>
      <button class="close-btn" (click)="toggleNotifications()">Ã—</button>
    </div>

    <div class="notification" *ngFor="let notification of notifications">
      <div class="notification-content">{{ notification.message }}</div>
      <div class="actions" *ngIf="notification.actions">
        <button class="primary" (click)="handleNotificationAction(notification, 'accept')">
          {{ notification.actions.accept }}
        </button>
        <button class="secondary" (click)="handleNotificationAction(notification, 'ignore')">
          {{ notification.actions.ignore }}
        </button>
      </div>
    </div>
  </div>

  <!-- Drawer overlay -->
  <div class="drawer-overlay" [class.show]="showNotifications" (click)="toggleNotifications()"></div>

  <!-- CREATE POST MODAL -->
  <app-create-post
    [userId]="userId"
    [show]="showCreateModal"
    (close)="closeCreateModal()"
    (postCreated)="onPostCreated()">
  </app-create-post>

  <!-- TOAST NOTIFICATION -->
  <div class="toast" [class.show]="showToast">
    <div class="toast-content">
      <svg class="toast-icon" viewBox="0 0 24 24" fill="currentColor">
        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
      </svg>
      <span class="toast-message">{{ toastMessage }}</span>
    </div>
  </div>

  <!-- POST VIEWER MODAL -->
  <app-post-viewer
    [show]="showPostViewer"
    [post]="selectedPost"
    [thumbnail]="selectedPost ? getThumbnail(selectedPost.postId) : null"
    (close)="closePostViewer()">
  </app-post-viewer>
  </div>
</div>
